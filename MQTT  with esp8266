#include <ESP8266WiFi.h>
#include <PubSubClient.h> //this library allows us to publish or subscribe messages in topic

const char* ssid="48y104298"; //wifi name
const char* password="048790627"; //wifi password
const char* mqttServer="mqtt://127.0.0.1:1883/";
const int mqttPort=1883;
const char* mqttUser="mqtt";
const char* mqttPassword="password";

void setup() {
  Serial.begin(115200);
  WiFi.begin(ssid, password);
  while(WiFi.status()!=WL_CONNECTED){
    delay(500);
    Serial.println("Connecting to WiFi...");
  }
  Serial.println("Connected to the WiFi network");

  while(!client.connected()){
    Serial.println("Connecting to MQTT...");
    if(client.connect("ESP8266Client", mqttUser, mqttPassword)){
      Serial.println("connected");
    }else{

      Serial.print("failed with state");
      Serial.print(client.state());
      delay(2000);
    }
    
    client.publish("esp/test","hello"); //Topic name
    client.subscribe("esp/test");
  }
}
